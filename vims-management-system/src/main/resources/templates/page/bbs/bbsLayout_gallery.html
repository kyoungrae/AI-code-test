<article id="bbsLayoutGalleryPage" class="gi-article-content gi-col-95 gi-row-100">
    <section class="gi-col-100 gi-row-100 gi-overflow-scroll">
        <header class="gi-margin-bottom-40px gi-padding-left-20px gi-padding-top-20px">
            <h1 class="gi-page-title" th:text="${bbsInfo.bbs_nm} + ' (갤러리)'">갤러리</h1>
            <p class="gi-subtitle-main">이미지 갤러리 목록</p>
        </header>
        <article>
            <div id="search-area" class="gi-padding-left-right-20px gi-margin-bottom-30px">
                <div class="gi-flex gi-flex-align-items-center gi-grid-gap-20px">
                    <button id="bbs-gallery-write-btn" class="gi-btn-blue gi-margin-left-auto">사진 등록</button>
                </div>
            </div>
            <div class="gi-row-100 gi-padding-left-right-20px">
                <div id="bbs_gallery_grid" class="gi-Grid gi-col-100"></div>
            </div>
        </article>
    </section>
</article>
<script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
    var bbsSessionData = JSON.parse(sessionStorage.getItem("DATA"));
    var bbsId = bbsSessionData ? bbsSessionData.bbs_id : 'default_id';
    var bbsNm = bbsSessionData ? bbsSessionData.bbs_nm : '갤러리';

    init();

    function init() {
        new PageInit();
        findByGalleryList();
        clickEvent();
    }

    function clickEvent() {
        $("#bbs-gallery-write-btn").on("click", function () {
            formUtil.apiLoadContent("cms", "/bbs/sysBbsBoardWrite", { bbs_id: bbsId });
        });
    }

    function findByGalleryList(page, range) {
        if (!page) page = 1;
        if (!range) range = 9; // 갤러리는 보통 3x3 느낌으로 9개씩

        let url = "/cms/common/sysBbsBoard/findPage";
        let param = {
            bbs_id: bbsId,
            page_no: page,
            row_range: range,
            offset: (page - 1) * range
        };

        axios.post(url, param).then(response => {
            if (response.status === 200) {
                let data = response.data.DATA;
                let paging = response.data.TOTAL_PAGING[0];

                let grid_header = {
                    title: bbsNm,
                    list: [
                        { HEADER: 'No', ID: 'no', WIDTH: '10', TYPE: 'text', TEXT_ALIGN: 'center', FONT_SIZE: '12px' },
                        { HEADER: Message.Label.Array["SYS_LAYOUT.IMAGE"], ID: 'thumbnail', WIDTH: '30', TYPE: 'img', TEXT_ALIGN: 'center', FONT_SIZE: '12px' },
                        { HEADER: Message.Label.Array["SYS_LAYOUT.TITLE"], ID: 'title', WIDTH: '60', TYPE: 'text', TEXT_ALIGN: 'left', FONT_SIZE: '12px' }
                    ]
                };

                let grid = formUtil.giGrid(grid_header, paging, page, "bbs_gallery_grid");
                grid.DataSet(data);
                grid.pagingSet(findByGalleryList);
            }
        });
    }
    /*]]>*/
</script>